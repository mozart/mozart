BUILDTOP        = @BUILDTOP@
VPATH           = @srcdir@
SRCDIR          = @srcdir@

PREFIX          = @prefix@
OZEX            = $(PREFIX)/examples

SHELL           = /bin/sh

@SET_MAKE@
INSTALL         = @INSTALL@
INSTALL_FILE    = $(INSTALL) -m 444
INSTALL_SRC     = @INSTALL_SRC@
INSTALL_DIR     = @INSTALL_DIR@

EXDIRS = \
        sampler sampler/constraints \
        fd fd/knights fd/queens \
        grammar grammar/shieber


OZEXDIRS = $(EXDIRS:%=$(OZEX)/%)

all:

$(OZEX) $(OZEXDIRS):
        $(INSTALL_DIR) $@

FD = \
        bin-packing bridge-naive bridge cars change \
        conference configuration donald family fraction \
        grocery kalotan knights knights/graphics magic-sequence \
        magic-square map-coloring money multiply photo \
        pythagoras queens queens/graphics safe srat \
        tiling warehouses zebra

GR = \
        hpsg shieber shieber/formalism shieber/grammar

EXAMPLES = \
        $(FD:%=$(OZEX)/fd/%.oz) \
        $(GR:%=$(OZEX)/grammar/%.oz)

SAMPLER0 = \
        constraints/animate-bridge constraints/bridge \
        constraints/draw-photo constraints/gantt constraints/machines \
        constraints/scheduling-compiler oz
SAMPLER = $(SAMPLER0:%=$(OZEX)/sampler/%.oz)

$(OZEX)/fd/%.oz: fd/%.oz
        $(INSTALL_SRC) $< $@

$(OZEX)/grammar/%.oz: grammar/%.oz
        $(INSTALL_SRC) $< $@
$(OZEX)/grammar/shieber/%.oz: grammar/shieber/%.oz
        $(INSTALL_SRC) $< $@
$(OZEX)/sampler/%.oz: sampler/%.oz
        $(INSTALL_SRC) $< $@
$(OZEX)/sampler/constraints/%.oz: sampler/constraints/%.oz
        $(INSTALL_SRC) $< $@


.PHONY: all install
.PHONY: clean veryclean

install: all $(OZEX) $(OZEXDIRS) $(SAMPLER) $(EXAMPLES)

clean:
        -rm -f *~ ./*/*~ ./*/*/*~

veryclean: clean

distclean: veryclean
        -rm -f Makefile

include $(SRCDIR)/../Makefile.boot

bootstrap:
        $(MAKE) boot-all

check:
